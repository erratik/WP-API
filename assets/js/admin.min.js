function MakePromise(a){var b={method:"POST",cache:!0,showErrors:!0,success:function(a){c.resolve(a)},error:function(a,b,d){400==a.status?(errorMessage=a.responseText,log({msg:"%c(╯°□°）╯ should be accompanied by custom message to display",color:"red"}),log({msg:errorMessage,color:"red"})):(log({msg:"%c(╯°□°）╯",color:"red"}),errorMessage={error:a.message,statusCode:a.code}),c.reject(errorMessage)}};$.extend(b,a.options);var c=$.Deferred();return $.ajax({type:b.method,url:a.url,data:a.data,success:b.success,error:b.error,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce)}}),c}function getSelectedVideos(){var a=[];return $(".wpvr_video.checked").each(function(){var b=$(this).prop("id"),c=b.replace("video_","");a.push(Number(c))}),a}function editSnaptubeVideos(a){var b=[];if("publish"==a){$.Deferred();$.ajax({url:wpApiSettings.root+"cutv/v2/videos/",success:function(a){b=_.map(a,function(a){a=a.data;var b=_.findIndex(editing_video_ids,function(b){return b==a.id})!=-1;if(b){console.log(a);var c=$("#video_"+a.id),d=c.find(".wpvr_video_thumb img").attr("src"),e="http://www.youtube.com/watch?v="+c.find('[post_id="'+a.id+'"]').attr("video_id"),f=a.content.rendered;return{categories:a.categories,description:f.replace(/<\/?[^>]+(>|$)/g,""),name:c.find(".wpvr_video_title").text(),file:e,slug:a.slug,duration:c.find(".wpvr_video_duration").text(),image:d,opimage:d.replace("-200x150",""),post_date:moment(a.date).format("YYYY-MM-DD HH:mm:ss"),link:e,member_id:a.author,id:a.id}}}),b=_.compact(b),_cutv.ajax(ajaxurl,{action:"cutv_convert_snaptube",videos:b}).then(function(a){$(".wpvr_manage_refresh:eq(0)").click(),$(".cutv_bulk_apply").attr("style","display: none !important;"),$(".wpvr_manage_bulk_actions_select").val(""),console.log(a)})}})}else _cutv.ajax(ajaxurl,{action:"cutv_convert_snaptube",videos:editing_video_ids,status:a}).then(function(a){$(".wpvr_manage_refresh:eq(0)").click(),$(".cutv_bulk_apply").attr("style","display: none !important;"),$(".wpvr_manage_bulk_actions_select").val(""),console.log(a)})}function log(a){var b={msg:null,level:DEBUG_LEVEL,group:!1,color:"blue"};$.extend(b,a),DEBUG_LEVEL>2&&"Microsoft Internet Explorer"!=navigator.appName&&console.log("%c"+a.msg,"color:"+a.color+";")}var $=jQuery,_tempData;jQuery(function(a){var b,c;a("body").one("mouseover",".wpvr_video",function(b){var c='<div class="cutv_bulk_apply pull-left"><button class="ui labeled icon button"><i class="add circle icon"></i>Apply to  <span class="wpvr_count_checked"></span> videos</button></div>';a(".wpvr_manage_bulk_actions").append(c)}).on("change",".wpvr_manage_bulk_actions_select",function(){switch(b=a(this).val()){case"publish":case"pending":case"trash":case"draft":c={action:"cutv_set_wpvr_videos_status",ids:getSelectedVideos(),status:b},a(".wpvr_manage_bulkApply").attr("style","display: none !important;"),a(".cutv_bulk_apply").attr("style","display: block !important;");break;default:console.log("default action chosen: ",b),a(".wpvr_manage_bulkApply").attr("style","display: block !important;"),a(".cutv_bulk_apply").attr("style","display: none !important;")}}).on("click",".cutv_bulk_apply",function(d){d.preventDefault(),editing_video_ids=getSelectedVideos(),console.log("editing "+editing_video_ids.length+" video(s): ",editing_video_ids),_cutv.ajax(ajaxurl,c).then(function(c){console.log(a(".wpvr_manage_bulk_actions_select").val(),b),editSnaptubeVideos(b),a(".wpvr_manage_refresh:eq(0)").click(),console.log(c)})}).on("click","#add-category-button",function(){var b=a('[name="cutv-new-channel-name"]').val(),c=b.toLowerCase();c=c.replace(/ /g,"-"),_cutv.ajax(wpApiSettings.root+"cutv/v2/categories",{description:"Mlkshk flannel deep v marfa hashtag brooklyn.",name:b,slug:c},{method:"POST"}).then(function(a){console.log(a),_cutv.ajax(ajaxurl,{action:"cutv_add_channel",channelName:a.name,slug:a.slug,description:a.description,cat_id:a.id}).then(function(a){})})})}).ajaxSuccess(function(a,b,c){var d,e=c.url;e.search("bulk_single_action")>0&&(console.log("URL: "+e),d=b.responseText),jQuery(".cutv_bulk_apply, .wpvr_manage_bulkApply").attr("style","display: none !important;"),jQuery(".wpvr_manage_bulk_actions_select").val("").hide()});var _cutv={ajax:function(a,b,c){return new MakePromise({url:a,data:b,options:c})}};DEBUG_LEVEL="cutv.dev"==window.location.hostname?3:0,"Microsoft Internet Explorer"==navigator.appName&&(DEBUG_LEVEL=0);