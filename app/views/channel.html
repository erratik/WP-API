<a class="ui labeled icon button teal right" href="#/">
    <i class="angle left icon"></i> Channels
</a>
<div class="ui teal header">
    <div class="ui small image channel">
        <img ng-src="/wp-content/uploads/channels/{{channel.cutv_channel_img}}" ng-if="channel.cutv_channel_img">
        <img ng-src="https://placeholdit.imgix.net/~text?txtsize=33&txt={{channel.playlist_name}}&w=200&h=200" ng-if="!channel.cutv_channel_img">
    </div>

    <div class="content">
        {{channel.playlist_name}}
        <div class="sub header mini">Channel Video & Source Management</div>
    </div>
</div>
<div class="ui divider"></div>
<div class="ui tabular menu">
    <a class="item" ng-click="activeTab = 'videos'" ng-class="{'active': activeTab === 'videos' }">
    Videos
  </a>
    <a class="item" ng-click="activeTab = 'sources'" ng-class="{'active': activeTab === 'sources' }">
    Sources
  </a>
    <a class="item" ng-click="activeTab = 'display'" ng-class="{'active': activeTab === 'display' }">
    Display
  </a>
</div>

<div ng-switch="activeTab">

    <div class="active loader inline ui" ng-switch-default>

    </div>
    <div id="sources" ng-controller="ChannelSourceCtrl" ng-switch-when="sources">

        <manage-sources channel="channel"></manage-sources>

    </div>

    <div id="display" ng-controller="ChannelDisplayCtrl" ng-switch-when="display">
        <div ng-include="'/wp-content/plugins/cutv-api/app/templates/includes/channel--display.html'"></div>
    </div>

    <div id="videos" ng-controller="ChannelVideosCtrl" ng-switch-when="videos">
        <div class="ui menu channel relative-wrapper">
            <div class="active loader ui" ng-if="working"></div>
            <div class="item">
                <div class="ui icon input">
                    <input type="text" placeholder="Search...">
                    <i class="search icon"></i>
                </div>
            </div>
            <div class="item" ng-show="selectedVideos.length">
                <select ng-model="selectedAction" ng-options="option.name for option in options">
                </select>
            </div>
            <div class="item" ng-if="selectedVideos.length">
                <button class="teal ui button" ng-click="updateChannelVideos()">{{selectedAction.name }} <a class="ui red circular tiny label">{{ selectedVideos.length }}</a></button>
            </div>
            <video-counts channel="channel" display="label"></video-counts>
        </div>

        <div class="ui divided items">

            <div class="ui grid item" ng-repeat="source in sources | orderBy:'source_id':false">


                <div class="ui grid fourteen row source-header">


                    <div class="eight wide column">
                        <h3>
                            {{source.source_name}}
                        </h3>

                    </div>
                    <div class="eight wide column">
                        <button class="ui green basic button right icon" ng-click="manageSourceVideos(source)">
                            <i class="film icon"></i>
                            Manage Videos
                        </button>
                         <a class="ui blue basic button right icon" href="/wp-admin/post.php?post={{source.source_id}}&action=edit" target="_blank">
                        <!-- <a class="ui blue basic button right icon" ng-click="openSourceDialog(source, 'edit')"> -->
                            <i class="youtube play icon"></i> Edit source
                        </a>
                        </button>
                        <a class="ui purple basic button right icon" href="/wp-admin/admin.php?page=wpvr&run_sources&ids={{source.source_id}}" target="_blank">
                            <i class="refresh icon"></i> Run source
                        </a>
                        <a class="ui red basic button right icon" ng-click="openSourceDialog(source, 'delete')">
                            <i class="refresh icon"></i> Delete source
                        </a>
                    </div>

                    <div class="ui modal" id="editSources_{{source.source_id}}">
                        <div class="header">Edit Source</div>
                        <div class="content">

                        </div>
                        <div class="actions">
                            <div class="ui approve button" ng-click="editSources(source)">Done</div>
                        </div>
                    </div>

                    <div class="ui modal" id="deleteSources_{{source.source_id}}">
                        <div class="header">Delete Source</div>
                        <div class="content">
                            <div class="grouped fields">
                                <label for="fruit">Move videos to another source:</label>
                                <div class="field" ng-repeat="newSrc in sources" ng-if="newSrc.source_id != source.source_id">
                                    <div>
                                        <input type="radio" ng-model="source.newSrc" ng-value="newSrc.source_id">
                                        <label>{{newSrc.source_name}}</label>
                                    </div>
                                </div>
                                <hr>
                                <div class=" field">
                                    <div>
                                        <input type="checkbox" tabindex="0" class="hidden" ng-model="source.movePlaylists">
                                        <label>Move playlists</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="actions">
                            <div class="ui approve button" ng-click="deleteSource(source)">Delete Source</div>
                            <div class="ui cancel button" ng-click="closeSourceDialog(source, 'delete')">Cancel</div>
                        </div>
                    </div>

                </div>
                <div class="ui grid sixteen wide column">
                    <div class="eight wide column">
                        <div class="ui list">
                            <div class="item">
                                <div class="ui left labeled tiny button" ng-click="setSourceFilter(source, {status: 'published'}); publishSelected = !publishSelected;">
                                    <a class="ui green left pointing label" ng-class="{'basic': publishSelected }">
                                            {{source.source_video_counts.published.length}}
                                        </a>
                                    <div class="ui button green tiny" ng-class="{'basic': !publishSelected}">
                                        Published Videos
                                    </div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="ui left labeled tiny button" ng-click="setSourceFilter(source, {status: 'pending'}); pendingSelected = !pendingSelected;">
                                    <a class="ui purple left pointing label" ng-class="{'basic': pendingSelected }">
                                            {{source.source_video_counts.pending.length}}
                                        </a>
                                    <div class="ui button purple tiny" ng-class="{'basic': !pendingSelected}">
                                        Pending Videos
                                    </div>
                                </div>
                            </div>
                            <div class="item">
                                <div class="ui left labeled tiny button" ng-click="setSourceFilter(source, {status: 'unpublished'}); unpublishSelected = !unpublishSelected;">
                                    <a class="ui grey left pointing label" ng-class="{'basic': unpublishSelected }">
                                            {{source.source_video_counts.unpublished.length}}
                                        </a>
                                    <div class="ui button grey tiny" ng-class="{'basic': !unpublishSelected}">
                                        Unpublished Videos
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row content videos" ng-show="source.managingVideos">


                    <!-- <div>
                                    <div class="ui icon input">
                    <input type="text" ng-model="source.query" placeholder="Filter unassigned sources">
                                        <i class="search icon"></i>
                                    </div>
                                    {{source.query}}
                                </div> -->
                    <div class="ui link cards">
                        <div class="card" ng-repeat="video in source.video_posts track by $index" ng-click="toggleVideoSelected(video)" ng-class="{'selected': video.selected}">

                            <div class="image">
                                <img ng-src="{{video.youtube_thumbnail}}">
                            </div>
                            <div class="content">
                                <div class="header">{{video.post_title}}</div>
                                <!--<div class="meta">
                                <div>
                                    <i class="ui icon user clock"></i>
                                    {{video.video_duration}}
                                </div>
                            </div>-->

                                <div class="ui label {{video.snaptube_status}}" ng-class="{'green': video.snaptube_status === 'published', 'grey' : video.snaptube_status === 'unpublished', 'purple' : video.snaptube_status === 'pending'}">
                                    <i class="fa wpvr_video_status_icon fa-check-square "></i>{{video.snaptube_status}}
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
